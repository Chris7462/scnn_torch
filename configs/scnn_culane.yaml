# SCNN Configuration for CULane Dataset

# Model
model:
  input_size: [288, 800]  # [height, width]
  ms_ks: 9                # Message passing kernel size
  pretrained: true

# Dataset
dataset:
  root: data/CULane
  resize_shape: [288, 800]  # [height, width]

# Dataloader
dataloader:
  batch_size: 8
  num_workers: 4

# Training
train:
  max_iter: 90000

# Augmentation
augmentation:
  rotation: 2.0
  horizontal_flip_prob: 0.5
  color_jitter_prob: 0.5
  motion_blur_prob: 0.2

# Optimizer
optimizer:
  type: SGD
  lr: 0.01
  momentum: 0.9
  weight_decay: 0.0001

# Learning rate scheduler
lr_scheduler:
  mode: min
  factor: 0.5
  patience: 5
  min_lr: 0.00001

# Loss
loss:
  seg_weight: 1.0
  exist_weight: 0.1
  background_weight: 0.4

# Normalization (ImageNet)
normalize:
  mean: [0.485, 0.456, 0.406]
  std: [0.229, 0.224, 0.225]

# Checkpoints (validation happens before each checkpoint save)
checkpoint:
  save_dir: checkpoints
  interval: 2000  # Save checkpoint (with validation) every N iterations

# Logging
logging:
  print_interval: 100  # Print every N iterations

# Evaluation
evaluation:
  resize_shape: [590, 1640]  # [height, width]
  y_px_gap: 20
  pts: 18
  thresh: 0.3
  # For official CULane evaluation tool (not used in Python evaluator)
  iou_threshold: 0.5
  lane_width: 30
